# Building libsai.so

## Bazel

Bazel is the preferred way to build Lemming. There are two bazel targets: the first statically links the library, the other dynamically links glog, protobuf, gRPC libraries.
The second is used to distribute a deb package for use in syncd. In order to ensure shared library version compatibility, bazel executes the build in a seperate docker container.
The image is not released publicly, but can be built using the [Dockerfile](../standalone/Dockerfile).

1. `bazel build //dataplane/standalone:sai-deb --config docker-bullseye`
   1. The `--config docker-bullseye` expands all the flags labeled `docker-bullseye` in `.bazelrc`
   2. These flags enable bazel docker sandbox and set up the toolchains for building the target in a custom docker container.
   3. The output of the command is a debian package built using a container based on `debian:bullseye`.
2. Built debian package is located at `bazel-bin/dataplane/standalone`

## RBE configs

The files in configs/bullseye are autogenerated using [rbe_configs_gen](https://github.com/bazelbuild/bazel-toolchains).
